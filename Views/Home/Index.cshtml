@{
    ViewBag.Title = "Home Page - CKEditor 4 Static Demo";
}

<div class="container">
    <h2 class="text-center mb-4">Demo CKEditor 4 - Soạn thảo & Xem trước</h2>

    <div class="row">
        <!-- Cột trái: Soạn thảo + nút Đăng -->
        <div class="col-md-6">
            <div class="mb-3">
                <label class="form-label" for="editor1">Nội dung bài viết</label>
                <!-- CKEditor 4 dùng <textarea> -->
                <textarea name="editor1" id="editor1" rows="10" class="form-control">
<p>Hello from CKEditor 4!</p>
<p>This is a static demo page converted from CKEditor 5 to CKEditor 4.</p>
<ul>
                <li>No license key needed.</li>
                <li>Loaded from CKEditor 4 open source CDN.</li>
</ul>
                </textarea>
            </div>

            <button type="button" id="btnDang" class="btn btn-primary">
                Đăng
            </button>
        </div>

        <!-- Cột phải: Kết quả sau khi ấn Đăng -->
        <div class="col-md-6">
            <h5>Kết quả hiển thị sau khi bấm "Đăng"</h5>
            <div id="preview" class="border rounded p-2" style="min-height: 300px;">
                <em>Nội dung sẽ hiển thị ở đây sau khi bạn bấm "Đăng".</em>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Make sure CKEditor 4 is available (layout should include CDN)
            if (typeof CKEDITOR === 'undefined') {
                console.error('CKEditor 4 not found. Ensure layout loads the CKEditor 4 script.');
                return;
            }

            // Initialize editor if not already
            var editorInst = CKEDITOR.instances['editor1'];
            try {
                if (!editorInst) {
                    editorInst = CKEDITOR.replace('editor1', { height: 350 });
                }
            } catch (err) {
                console.error('Error initializing CKEditor:', err);
            }

            // Bind Đăng button
            var btn = document.getElementById('btnDang');
            if (!btn) {
                console.error('Button #btnDang not found');
                return;
            }

            btn.addEventListener('click', function (e) {
                e.preventDefault();
                var content = '';

                if (CKEDITOR.instances && CKEDITOR.instances['editor1'] && typeof CKEDITOR.instances['editor1'].getData === 'function') {
                    content = CKEDITOR.instances['editor1'].getData();
                } else {
                    var ta = document.getElementById('editor1');
                    content = ta ? ta.value : '';
                }

                var preview = document.getElementById('preview');
                if (preview) {
                    preview.innerHTML = content || '<em>(Nội dung trống)</em>';
                }
            });
        });
    </script>
}
